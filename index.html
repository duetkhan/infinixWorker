<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Infinix Worker</title>
<script src="ads.js"></script>
</head>
<body>

<h2>Infinix Worker</h2>

<div id="top-banner"></div>

<button id="start-work">Start Work</button>
<button id="watch-ad">Watch Ad For Reward</button>

<p>Balance: <span id="balance">0</span> TK</p>
<button onclick="location.href='withdraw.html'">Withdraw</button>

<div id="bottom-banner"></div>

<script>
showBanner("top-banner");
showBanner("bottom-banner");

let balance = Number(localStorage.getItem("balance") || 0);
document.getElementById("balance").innerText = balance;

// Start Work
document.getElementById("start-work").onclick = ()=>{
    showPopunderAd();     // Popunder only on click (browser block করবে না)
    window.open(SMARTLINK1, "_blank");
};

// Watch ad for reward
document.getElementById("watch-ad").onclick = ()=>{
    const start = Date.now();
    const w = window.open(SMARTLINK2, "_blank");

    const timer = setInterval(()=>{
        if(w.closed){
            const diff = (Date.now() - start) / 1000;
            if(diff >= 60){
                const reward = Math.floor(Math.random()*3)+2; // 2-4 TK
                balance += reward;
                localStorage.setItem("balance", balance);
                alert("You earned "+reward+" TK");
            } else {
                alert("No reward! Too early closed.");
            }
            document.getElementById("balance").innerText = balance;
            clearInterval(timer);
        }
    },1000);
};
</script>

</body>
</html>
